INFO:__main__:Log path : log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_852.pickle
INFO:__main__:Log path : log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_956.pickle
INFO:__main__:Log path : log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_852.pickle
INFO:__main__:Log path : log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_066.pickle
INFO:__main__:Log path : log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_252.pickle
INFO:root:New directory created
INFO:root:New directory created
INFO:root:New directory created
INFO:root:New directory created
Traceback (most recent call last):
  File "scripts/main_gnn_qm9.py", line 245, in <module>
    main()
  File "scripts/main_gnn_qm9.py", line 103, in main
    logger = logs.Logger(args.log_path)
  File "/misc/vlgscratch4/BrunaGroup/sulem/chem/HGNN/functions/logs.py", line 43, in __init__
    os.mkdir(log_dir)
FileExistsError: [Errno 17] File exists: 'log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_852.pickle'
INFO:__main__:Working on CPU
INFO:root:Loading data...
INFO:__main__:Working on CPU
INFO:root:Loading data...
INFO:__main__:Working on CPU
INFO:root:Loading data...
INFO:__main__:Working on CPU
INFO:root:Loading data...
INFO:__main__:Number of training instances : 10710
INFO:__main__:Number of validation instances : 1338
INFO:__main__:Network created
INFO:__main__:Training the GNN
INFO:__main__:Number of training instances : 10710
INFO:__main__:Number of training instances : 10710
INFO:__main__:Number of training instances : 10710
INFO:__main__:Number of validation instances : 1338
INFO:__main__:Number of validation instances : 1338
INFO:__main__:Number of validation instances : 1338
INFO:__main__:Network created
INFO:__main__:Training the GNN
INFO:__main__:Network created
INFO:__main__:Training the GNN
INFO:__main__:Network created
INFO:__main__:Training the GNN
INFO:__main__:Epoch 1 : Avg Error 2.947; Average Loss 13.713 Time : 152
INFO:__main__:Epoch 1 : Avg Error 1.278; Average Loss 4.469 Time : 155
INFO:__main__:Epoch 1 : Avg Error 1.491; Average Loss 5.059 Time : 155
INFO:__main__:Epoch 1 : Avg Error 31.509; Average Loss 1038.893 Time : 158
INFO:__main__:Epoch 2 : Avg Error 1.503; Average Loss 3.861 Time : 152
INFO:__main__:Epoch 2 : Avg Error 0.871; Average Loss 1.846 Time : 155
INFO:__main__:Epoch 2 : Avg Error 1.290; Average Loss 3.518 Time : 155
INFO:__main__:Epoch 2 : Avg Error 13.966; Average Loss 240.568 Time : 158
INFO:__main__:Epoch 3 : Avg Error 1.154; Average Loss 2.216 Time : 153
INFO:__main__:Epoch 3 : Avg Error 0.749; Average Loss 1.509 Time : 155
INFO:__main__:Epoch 3 : Avg Error 1.194; Average Loss 2.906 Time : 156
INFO:__main__:Epoch 3 : Avg Error 3.412; Average Loss 30.718 Time : 158
INFO:__main__:Epoch 4 : Avg Error 0.878; Average Loss 1.451 Time : 153
INFO:__main__:Epoch 4 : Avg Error 0.644; Average Loss 0.865 Time : 156
INFO:__main__:Epoch 4 : Avg Error 1.039; Average Loss 2.082 Time : 156
INFO:__main__:Epoch 4 : Avg Error 1.697; Average Loss 6.583 Time : 159
Traceback (most recent call last):
  File "scripts/main_gnn_qm9.py", line 245, in <module>
    main()
  File "scripts/main_gnn_qm9.py", line 195, in main
    logger.add_epoch_info(epoch+1,run_loss.val, run_error.val, dur)
  File "/misc/vlgscratch4/BrunaGroup/sulem/chem/HGNN/functions/logs.py", line 130, in add_epoch_info
    with open(self.res_file, 'a') as file:
FileNotFoundError: [Errno 2] No such file or directory: 'log/qm9/lg_False_up_1_bs_30_ep_40_st_10_op_adamax_lr_0.0003_da_0.9_L_20_h_2_ta_0_066.pickle/results.txt'
INFO:__main__:Epoch 5 : Avg Error 0.636; Average Loss 0.741 Time : 156
INFO:__main__:Epoch 5 : Avg Error 1.106; Average Loss 2.122 Time : 157
INFO:__main__:Epoch 5 : Avg Error 1.468; Average Loss 4.101 Time : 160
INFO:__main__:Epoch 6 : Avg Error 0.598; Average Loss 0.625 Time : 157
INFO:__main__:Epoch 6 : Avg Error 0.857; Average Loss 1.539 Time : 156
INFO:__main__:Epoch 6 : Avg Error 0.955; Average Loss 1.557 Time : 159
INFO:__main__:Epoch 7 : Avg Error 0.593; Average Loss 0.602 Time : 158
INFO:__main__:Epoch 7 : Avg Error 0.858; Average Loss 1.433 Time : 157
INFO:__main__:Epoch 7 : Avg Error 0.849; Average Loss 1.158 Time : 160
INFO:__main__:Epoch 8 : Avg Error 0.627; Average Loss 0.705 Time : 158
INFO:__main__:Epoch 8 : Avg Error 0.796; Average Loss 1.193 Time : 157
INFO:__main__:Epoch 8 : Avg Error 0.855; Average Loss 1.142 Time : 160
INFO:__main__:Epoch 9 : Avg Error 0.593; Average Loss 0.598 Time : 157
INFO:__main__:Epoch 9 : Avg Error 0.755; Average Loss 1.187 Time : 157
INFO:__main__:Epoch 9 : Avg Error 0.808; Average Loss 1.045 Time : 159
INFO:__main__:Epoch 10 : Avg Error 0.591; Average Loss 0.571 Time : 158
INFO:__main__:Epoch 10 : Avg Error 0.731; Average Loss 1.082 Time : 158
INFO:__main__:Epoch 10 : Avg Error 0.822; Average Loss 1.064 Time : 160
INFO:__main__:Epoch 11 : Avg Error 0.585; Average Loss 0.556 Time : 158
INFO:__main__:Epoch 11 : Avg Error 0.678; Average Loss 0.977 Time : 158
INFO:__main__:Epoch 11 : Avg Error 0.818; Average Loss 1.068 Time : 160
INFO:__main__:Epoch 12 : Avg Error 0.710; Average Loss 1.045 Time : 157
INFO:__main__:Epoch 12 : Avg Error 0.587; Average Loss 0.546 Time : 158
INFO:__main__:Epoch 12 : Avg Error 0.808; Average Loss 1.005 Time : 160
INFO:__main__:Epoch 13 : Avg Error 0.646; Average Loss 0.939 Time : 157
INFO:__main__:Epoch 13 : Avg Error 0.587; Average Loss 0.539 Time : 158
INFO:__main__:Epoch 13 : Avg Error 0.790; Average Loss 0.927 Time : 160
INFO:__main__:Epoch 14 : Avg Error 0.608; Average Loss 0.814 Time : 157
INFO:__main__:Epoch 14 : Avg Error 0.592; Average Loss 0.542 Time : 158
INFO:__main__:Epoch 14 : Avg Error 0.797; Average Loss 0.939 Time : 160
INFO:__main__:Epoch 15 : Avg Error 0.630; Average Loss 0.792 Time : 158
INFO:__main__:Epoch 15 : Avg Error 0.581; Average Loss 0.527 Time : 158
INFO:__main__:Epoch 15 : Avg Error 0.803; Average Loss 0.987 Time : 161
INFO:__main__:Epoch 16 : Avg Error 0.556; Average Loss 0.625 Time : 158
INFO:__main__:Epoch 16 : Avg Error 0.582; Average Loss 0.518 Time : 159
INFO:__main__:Epoch 16 : Avg Error 0.731; Average Loss 0.847 Time : 161
INFO:__main__:Epoch 17 : Avg Error 0.540; Average Loss 0.678 Time : 159
INFO:__main__:Epoch 17 : Avg Error 0.581; Average Loss 0.510 Time : 159
INFO:__main__:Epoch 17 : Avg Error 0.721; Average Loss 0.821 Time : 161
INFO:__main__:Epoch 18 : Avg Error 0.552; Average Loss 0.686 Time : 159
INFO:__main__:Epoch 18 : Avg Error 0.576; Average Loss 0.503 Time : 159
INFO:__main__:Epoch 18 : Avg Error 0.707; Average Loss 0.761 Time : 161
INFO:__main__:Epoch 19 : Avg Error 0.548; Average Loss 0.691 Time : 160
INFO:__main__:Epoch 19 : Avg Error 0.579; Average Loss 0.501 Time : 159
INFO:__main__:Epoch 19 : Avg Error 0.714; Average Loss 0.761 Time : 165
INFO:__main__:Epoch 20 : Avg Error 0.578; Average Loss 0.493 Time : 159
INFO:__main__:Epoch 20 : Avg Error 0.523; Average Loss 0.673 Time : 165
INFO:__main__:Epoch 20 : Avg Error 0.689; Average Loss 0.717 Time : 168
INFO:__main__:Epoch 21 : Avg Error 0.578; Average Loss 0.494 Time : 160
INFO:__main__:Epoch 21 : Avg Error 0.565; Average Loss 0.771 Time : 166
INFO:__main__:Epoch 21 : Avg Error 0.832; Average Loss 0.951 Time : 169
INFO:__main__:Epoch 22 : Avg Error 0.575; Average Loss 0.486 Time : 160
INFO:__main__:Epoch 22 : Avg Error 0.557; Average Loss 0.776 Time : 166
INFO:__main__:Epoch 22 : Avg Error 0.687; Average Loss 0.724 Time : 169
INFO:__main__:Epoch 23 : Avg Error 0.573; Average Loss 0.482 Time : 160
INFO:__main__:Epoch 23 : Avg Error 0.567; Average Loss 0.741 Time : 166
INFO:__main__:Epoch 23 : Avg Error 0.777; Average Loss 0.845 Time : 169
INFO:__main__:Epoch 24 : Avg Error 0.576; Average Loss 0.492 Time : 160
INFO:__main__:Epoch 24 : Avg Error 0.542; Average Loss 0.678 Time : 166
INFO:__main__:Epoch 24 : Avg Error 0.801; Average Loss 0.884 Time : 170
INFO:__main__:Epoch 25 : Avg Error 0.576; Average Loss 0.488 Time : 160
INFO:__main__:Epoch 25 : Avg Error 0.518; Average Loss 0.665 Time : 166
INFO:__main__:Epoch 25 : Avg Error 0.615; Average Loss 0.580 Time : 170
INFO:__main__:Epoch 26 : Avg Error 0.576; Average Loss 0.488 Time : 161
INFO:__main__:Epoch 26 : Avg Error 0.506; Average Loss 0.604 Time : 167
INFO:__main__:Epoch 26 : Avg Error 0.648; Average Loss 0.655 Time : 171
INFO:__main__:Epoch 27 : Avg Error 0.572; Average Loss 0.478 Time : 161
INFO:__main__:Epoch 27 : Avg Error 0.511; Average Loss 0.629 Time : 167
INFO:__main__:Epoch 27 : Avg Error 0.643; Average Loss 0.631 Time : 171
INFO:__main__:Epoch 28 : Avg Error 0.572; Average Loss 0.474 Time : 161
INFO:__main__:Epoch 28 : Avg Error 0.526; Average Loss 0.619 Time : 165
INFO:__main__:Epoch 28 : Avg Error 0.644; Average Loss 0.630 Time : 167
INFO:__main__:Epoch 29 : Avg Error 0.572; Average Loss 0.476 Time : 162
INFO:__main__:Epoch 29 : Avg Error 0.473; Average Loss 0.534 Time : 196
INFO:__main__:Epoch 29 : Avg Error 0.605; Average Loss 0.563 Time : 174
INFO:__main__:Epoch 30 : Avg Error 0.568; Average Loss 0.473 Time : 161
INFO:__main__:Epoch 30 : Avg Error 0.513; Average Loss 0.550 Time : 163
INFO:__main__:Epoch 30 : Avg Error 0.746; Average Loss 0.757 Time : 167
INFO:__main__:Epoch 31 : Avg Error 0.568; Average Loss 0.470 Time : 162
INFO:__main__:Epoch 31 : Avg Error 0.487; Average Loss 0.568 Time : 163
INFO:__main__:Epoch 31 : Avg Error 0.607; Average Loss 0.556 Time : 167
INFO:__main__:Epoch 32 : Avg Error 0.568; Average Loss 0.467 Time : 162
INFO:__main__:Epoch 32 : Avg Error 0.460; Average Loss 0.492 Time : 162
INFO:__main__:Epoch 32 : Avg Error 0.553; Average Loss 0.479 Time : 167
INFO:__main__:Epoch 33 : Avg Error 0.566; Average Loss 0.465 Time : 162
INFO:__main__:Epoch 33 : Avg Error 0.491; Average Loss 0.575 Time : 163
INFO:__main__:Epoch 34 : Avg Error 0.565; Average Loss 0.467 Time : 173
INFO:__main__:Epoch 33 : Avg Error 0.733; Average Loss 0.732 Time : 175
INFO:__main__:Epoch 34 : Avg Error 0.514; Average Loss 0.577 Time : 172
/var/lib/slurm/slurmd/job68299/slurm_script: line 19: 16758 Killed                  python3 scripts/main_gnn_qm9.py --lr $lr --lrdamping $lrdamp --step $step --data_path $data_path --epochs $epochs
INFO:__main__:Epoch 34 : Avg Error 0.574; Average Loss 0.514 Time : 4064
INFO:__main__:Epoch 35 : Avg Error 0.482; Average Loss 0.544 Time : 4058
INFO:__main__:Epoch 35 : Avg Error 0.752; Average Loss 0.752 Time : 176
INFO:__main__:Epoch 36 : Avg Error 0.443; Average Loss 0.481 Time : 171
INFO:__main__:Epoch 36 : Avg Error 0.536; Average Loss 0.437 Time : 177
INFO:__main__:Epoch 37 : Avg Error 0.441; Average Loss 0.453 Time : 172
INFO:__main__:Epoch 37 : Avg Error 0.531; Average Loss 0.453 Time : 177
INFO:__main__:Epoch 38 : Avg Error 0.429; Average Loss 0.450 Time : 171
INFO:__main__:Epoch 38 : Avg Error 0.525; Average Loss 0.446 Time : 203
/var/lib/slurm/slurmd/job68300/slurm_script: line 19: 16710 Killed                  python3 scripts/main_gnn_qm9.py --lr $lr --lrdamping $lrdamp --step $step --data_path $data_path --epochs $epochs
INFO:__main__:Epoch 39 : Avg Error 0.534; Average Loss 0.471 Time : 191
INFO:__main__:Epoch 40 : Avg Error 0.575; Average Loss 0.514 Time : 166
INFO:__main__:Training finished : Duration 10568 secs, Avg Loss 0.514, Mean Average Error 0.575, Error ratio 5.753
INFO:root:Model saved
INFO:__main__:Evaluating on the validation set...
WARNING:root:Testing on 1338 molecules
INFO:root:Batch 1 Loss : 0.541 Error : 0.593
INFO:root:Batch 2 Loss : 2.210 Error : 0.663
INFO:root:Batch 3 Loss : 0.228 Error : 0.400
INFO:root:Batch 4 Loss : 0.512 Error : 0.523
INFO:root:Batch 5 Loss : 0.250 Error : 0.388
INFO:root:Batch 6 Loss : 0.095 Error : 0.253
INFO:root:Batch 7 Loss : 0.493 Error : 0.453
INFO:root:Batch 8 Loss : 0.824 Error : 0.754
INFO:root:Batch 9 Loss : 18.588 Error : 1.052
INFO:root:Batch 10 Loss : 0.165 Error : 0.307
INFO:root:Batch 11 Loss : 0.723 Error : 0.759
INFO:root:Batch 12 Loss : 22.414 Error : 1.300
INFO:root:Batch 13 Loss : 0.423 Error : 0.514
INFO:root:Batch 14 Loss : 0.900 Error : 0.791
INFO:root:Batch 15 Loss : 0.256 Error : 0.406
INFO:root:Batch 16 Loss : 0.551 Error : 0.651
INFO:root:Batch 17 Loss : 10.783 Error : 1.067
INFO:root:Batch 18 Loss : 0.199 Error : 0.363
INFO:root:Batch 19 Loss : 0.180 Error : 0.326
INFO:root:Batch 20 Loss : 0.313 Error : 0.434
INFO:root:Batch 21 Loss : 4.661 Error : 0.722
INFO:root:Batch 22 Loss : 0.429 Error : 0.488
INFO:root:Batch 23 Loss : 0.311 Error : 0.386
INFO:root:Batch 24 Loss : 7.267 Error : 1.273
INFO:root:Batch 25 Loss : 0.274 Error : 0.388
INFO:root:Batch 26 Loss : 0.236 Error : 0.393
INFO:root:Batch 27 Loss : 25.390 Error : 1.262
INFO:root:Batch 28 Loss : 898.541 Error : 6.118
INFO:root:Batch 29 Loss : 0.268 Error : 0.375
INFO:root:Batch 30 Loss : 0.162 Error : 0.331
INFO:root:Batch 31 Loss : 0.464 Error : 0.543
INFO:root:Batch 32 Loss : 0.463 Error : 0.536
INFO:root:Batch 33 Loss : 2.089 Error : 0.650
INFO:root:Batch 34 Loss : 0.356 Error : 0.423
INFO:root:Batch 35 Loss : 0.153 Error : 0.308
INFO:root:Batch 36 Loss : 4.712 Error : 0.709
INFO:root:Batch 37 Loss : 0.319 Error : 0.434
INFO:root:Batch 38 Loss : 0.317 Error : 0.349
INFO:root:Batch 39 Loss : 0.174 Error : 0.332
INFO:root:Batch 40 Loss : 0.507 Error : 0.561
INFO:root:Batch 41 Loss : 0.272 Error : 0.414
INFO:root:Batch 42 Loss : 0.219 Error : 0.346
INFO:root:Batch 43 Loss : 8.452 Error : 0.985
INFO:root:Batch 44 Loss : 0.292 Error : 0.439
INFO:root:Batch 45 Loss : 0.342 Error : 0.479
INFO:__main__:Validation finished : Avg loss 22.807, Mean Average Error 0.696, Error ratio 6.963
/var/lib/slurm/slurmd/job68301/slurm_script: line 19: 16733 Killed                  python3 scripts/main_gnn_qm9.py --lr $lr --lrdamping $lrdamp --step $step --data_path $data_path --epochs $epochs
